# WireGuard服务端配置文件
# 部署路径: /etc/wireguard/wg0.conf
# 使用前请替换所有占位符

[Interface]
# 服务端私钥 - 使用 wg genkey 生成
PrivateKey = {{SERVER_PRIVATE_KEY}}

# 服务端在VPN网段的IP地址
Address = 10.8.0.1/24

# WireGuard监听端口
ListenPort = 51820

# 网络接口名称 (根据实际情况调整)
# 常见的有: eth0, ens3, enp0s3
PostUp = iptables -A FORWARD -i wg0 -j ACCEPT; iptables -t nat -A POSTROUTING -o {{NETWORK_INTERFACE}} -j MASQUERADE
PostDown = iptables -D FORWARD -i wg0 -j ACCEPT; iptables -t nat -D POSTROUTING -o {{NETWORK_INTERFACE}} -j MASQUERADE

# 工厂模块端配置
[Peer]
# 模块端公钥
PublicKey = {{MODULE_PUBLIC_KEY}}
# 模块端允许的IP范围 (VPN IP + 工厂内网段)
AllowedIPs = 10.8.0.2/32, 192.168.1.0/24
# 保持连接活跃
PersistentKeepalive = 25

# 外部用户1配置
[Peer]
PublicKey = {{USER1_PUBLIC_KEY}}
AllowedIPs = 10.8.0.10/32

# 外部用户2配置
[Peer]
PublicKey = {{USER2_PUBLIC_KEY}}
AllowedIPs = 10.8.0.11/32

# 外部用户3配置
[Peer]
PublicKey = {{USER3_PUBLIC_KEY}}
AllowedIPs = 10.8.0.12/32

# 管理员用户配置
[Peer]
PublicKey = {{ADMIN_PUBLIC_KEY}}
AllowedIPs = 10.8.0.20/32

# 如需添加更多用户，继续添加 [Peer] 段落
# 注意：每个用户需要唯一的IP地址和公钥 